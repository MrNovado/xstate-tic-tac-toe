(this["webpackJsonpxstate-tic-tac-toe"]=this["webpackJsonpxstate-tic-tac-toe"]||[]).push([[0],{35:function(t,e,n){},40:function(t,e,n){"use strict";n.r(e);var r=n(9),i=n.n(r),a=n(27),c=n.n(a),o=(n(35),function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,47)).then((function(e){var n=e.getCLS,r=e.getFID,i=e.getFCP,a=e.getLCP,c=e.getTTFB;n(t),r(t),i(t),a(t),c(t)}))}),u=n(21),l=n(44),d=n(45),s="user",O="agent",y="player1",b="player2",f="x",j="0",p=[[0,1,2],[3,4,5],[6,7,8]],T=[[0,3,6],[1,4,7],[2,5,8]],v=[[0,4,8],[2,4,6]],x={CORNERS:{TOP_LEFT:0,TOP_RIGHT:2,BOT_LEFT:6,BOT_RIGHT:8},EDGES:{TOP:1,LEFT:3,RIGHT:5,BOT:7},CENTER:4,COMBINATIONS:[].concat(p,T,v),ROWS:p,COLUMNS:T,DIAGONALS:v},R=[null,null,null,null,null,null,null,null,null],E="CHANGE_PLAYER_REQ",m="CONTINUE_REQ",g="CHANGE_TURN_ORDER_REQ",h="CHANGE_TRANSITION_DELAY_REQ",C="ACCEPT_TURN_REQ",N="GIVE_UP_TURN_REQ",S="RETRY_REQ",_="SET_UP_NEW_GAME",I={0:0,default:300,500:500,700:700,1e3:1e3},k="MAKE_TURN_REQ",D=n(30),G=n(12),B=n(2),P=n(46),w=n(6),F=n(43),L=n(22),M=n.n(L),A="@/awaitingTurn",H="@/makingTurn",U="@/tryingToWin",W="@/tryingToBlockWin",Q="@/tryingToFork",K="@/tryingToBlockFork",Y="@/tryingToTakeCenter",z="@/tryingToTakeOppositeCorner",J="@/tryingToTakeCorner",V="@/tryingToTakeEmptySide",q="@/givingUp",X="verifyTurnReady",Z="saveField",$="makeTurn",tt="tryWinning",et="tryBlockingWin",nt="tryForking",rt="tryBlockingFork",it="tryTakingCenter",at="tryTakingOppositeCorner",ct="tryTakingCorner",ot="tryTakingSide",ut="giveUp",lt=n(14);function dt(t){return t===f?j:f}var st={target:H,cond:X,delay:function(t){return t.transitionDelay}},Ot=function(t){var e,n;return Object(P.a)({context:{field:R,player:b,symbol:t,moveReady:null,transitionDelay:I.default},initial:A,states:(e={},Object(B.a)(e,A,{on:Object(B.a)({},k,{target:U,actions:[Z]})}),Object(B.a)(e,H,{after:[{target:A,actions:$,delay:function(t){return t.transitionDelay}}]}),Object(B.a)(e,U,{entry:tt,after:[st,{target:W,delay:function(t){return t.transitionDelay}}]}),Object(B.a)(e,W,{entry:et,after:[st,{target:Q,delay:function(t){return t.transitionDelay}}]}),Object(B.a)(e,Q,{entry:nt,after:[st,{target:K,delay:function(t){return t.transitionDelay}}]}),Object(B.a)(e,K,{entry:rt,after:[st,{target:Y,delay:function(t){return t.transitionDelay}}]}),Object(B.a)(e,Y,{entry:it,after:[st,{target:z,delay:function(t){return t.transitionDelay}}]}),Object(B.a)(e,z,{entry:at,after:[st,{target:J,delay:function(t){return t.transitionDelay}}]}),Object(B.a)(e,J,{entry:ct,after:[st,{target:V,delay:function(t){return t.transitionDelay}}]}),Object(B.a)(e,V,{entry:ot,after:[st,{target:q,delay:function(t){return t.transitionDelay}}]}),Object(B.a)(e,q,{after:[{target:A,actions:ut,delay:function(t){return t.transitionDelay}}]}),e)},{guards:Object(B.a)({},X,(function(t){var e=t.moveReady;return"commit"===(null===e||void 0===e?void 0:e.type)})),actions:(n={},Object(B.a)(n,Z,Object(w.b)({player:function(t,e){return e.player},field:function(t,e){return e.field},transitionDelay:function(t,e){return e.transitionDelay}})),Object(B.a)(n,$,Object(w.l)((function(t){var e=t.player,n=t.moveReady;return"commit"===(null===n||void 0===n?void 0:n.type)?{type:C,index:n.turnTo,sender:e}:{type:N}}),{delay:300})),Object(B.a)(n,ut,Object(w.l)((function(){return{type:N}}),{delay:300})),Object(B.a)(n,tt,Object(w.b)({moveReady:function(t){return yt(t.field,t.symbol)}})),Object(B.a)(n,et,Object(w.b)({moveReady:function(t){return yt(t.field,dt(t.symbol))}})),Object(B.a)(n,nt,Object(w.b)({moveReady:function(t){return bt(t.field,t.symbol)}})),Object(B.a)(n,rt,Object(w.b)({moveReady:function(t){return bt(t.field,dt(t.symbol))}})),Object(B.a)(n,it,Object(w.b)({moveReady:function(t){return null===t.field[x.CENTER]?{type:"commit",turnTo:x.CENTER}:{type:"tryOtherMove"}}})),Object(B.a)(n,at,Object(w.b)({moveReady:function(t){var e=t.field,n=dt(t.symbol),r=[{is:e[x.CORNERS.TOP_LEFT]===n&&null===e[x.CORNERS.BOT_RIGHT],index:x.CORNERS.BOT_RIGHT},{is:e[x.CORNERS.TOP_RIGHT]===n&&null===e[x.CORNERS.BOT_LEFT],index:x.CORNERS.BOT_LEFT},{is:e[x.CORNERS.BOT_LEFT]===n&&null===e[x.CORNERS.TOP_RIGHT],index:x.CORNERS.TOP_RIGHT},{is:e[x.CORNERS.BOT_RIGHT]===n&&null===e[x.CORNERS.TOP_LEFT],index:x.CORNERS.TOP_LEFT}].filter((function(t){return t.is})),i=M()(r);return i?{type:"commit",turnTo:i.index}:{type:"tryOtherMove"}}})),Object(B.a)(n,ct,Object(w.b)({moveReady:function(t){var e=t.field,n=[{value:e[x.CORNERS.TOP_LEFT],index:x.CORNERS.TOP_LEFT},{value:e[x.CORNERS.TOP_RIGHT],index:x.CORNERS.TOP_RIGHT},{value:e[x.CORNERS.BOT_LEFT],index:x.CORNERS.BOT_LEFT},{value:e[x.CORNERS.BOT_RIGHT],index:x.CORNERS.BOT_RIGHT}].filter((function(t){return null===t.value})),r=M()(n);return r?{type:"commit",turnTo:r.index}:{type:"tryOtherMove"}}})),Object(B.a)(n,ot,Object(w.b)({moveReady:function(t){var e=t.field,n=[{value:e[x.EDGES.TOP],index:x.EDGES.TOP},{value:e[x.EDGES.LEFT],index:x.EDGES.LEFT},{value:e[x.EDGES.RIGHT],index:x.EDGES.RIGHT},{value:e[x.EDGES.BOT],index:x.EDGES.BOT}].filter((function(t){return null===t.value})),r=M()(n);return r?{type:"commit",turnTo:r.index}:{type:"tryOtherMove"}}})),n)})};function yt(t,e){var n=function(t,e){var n=dt(e);return x.COMBINATIONS.find((function(r){return 2===r.reduce((function(r,i){return t[i]===e?r+1:t[i]===n?r-1:r}),0)}))}(t,e),r=null===n||void 0===n?void 0:n.find((function(e){return null===t[e]}));return void 0!==r?{type:"commit",turnTo:r}:{type:"tryOtherMove"}}function bt(t,e){var n=function(t,e){var n=function(n){return 1===n.reduce((function(n,r){return t[r]===e?n+1:null===t[r]?n:n-1}),0)},r=p.filter(n),i=T.filter(n),a=v.filter(n);if(r.length){var c,o=Object(lt.a)(r);try{for(o.s();!(c=o.n()).done;){var u,l=c.value,d=Object(lt.a)(l);try{for(d.s();!(u=d.n()).done;){var s,O=u.value,y=Object(lt.a)(i);try{for(y.s();!(s=y.n()).done;){var b=O in s.value,f=null===t[O];if(b&&f)return{intersectionIndex:O}}}catch(B){y.e(B)}finally{y.f()}var j,R=Object(lt.a)(a);try{for(R.s();!(j=R.n()).done;){var E=O in j.value,m=null===t[O];if(E&&m)return{intersectionIndex:O}}}catch(B){R.e(B)}finally{R.f()}}}catch(B){d.e(B)}finally{d.f()}}}catch(B){o.e(B)}finally{o.f()}}if(i.length){var g,h=Object(lt.a)(i);try{for(h.s();!(g=h.n()).done;){var C,N=g.value,S=Object(lt.a)(N);try{for(S.s();!(C=S.n()).done;){var _,I=C.value,k=Object(lt.a)(a);try{for(k.s();!(_=k.n()).done;){var D=I in _.value,G=null===t[I];if(D&&G)return{intersectionIndex:I}}}catch(B){k.e(B)}finally{k.f()}}}catch(B){S.e(B)}finally{S.f()}}}catch(B){h.e(B)}finally{h.f()}}return 2===a.length&&null===t[x.CENTER]?{intersectionIndex:x.CENTER}:null}(t,e);return n?{type:"commit",turnTo:n.intersectionIndex}:{type:"tryOtherMove"}}var ft,jt,pt,Tt,vt,xt,Rt,Et,mt="@/settingUp",gt="@/playing",ht="@/playing/takingTurn",Ct="@/playing/checkingGameState",Nt="@/showingGameEndResults",St="setPlayer",_t="setTurnOrder",It="setTransitionDelay",kt="awaitTurn",Dt="tryGameEnd",Gt="saveTurn",Bt="saveSurrender",Pt="switchTurn",wt="revertContextToInitial",Ft="revertContextButOpponents",Lt="verifyTurn",Mt="verifyGameEnd",At={actorTransitionDelay:I.default,opponents:(ft={},Object(B.a)(ft,y,{type:s,symbol:f}),Object(B.a)(ft,b,{type:s,symbol:j}),ft),turnOrder:{current:y,turnsMade:0},field:R,winCombo:null,surrendered:null},Ht=Object(P.a)({context:At,initial:mt,states:(xt={},Object(B.a)(xt,mt,{on:(jt={},Object(B.a)(jt,E,{actions:[St]}),Object(B.a)(jt,g,{actions:[_t]}),Object(B.a)(jt,h,{actions:[It]}),Object(B.a)(jt,m,{target:gt}),jt)}),Object(B.a)(xt,gt,{initial:ht,states:(Tt={},Object(B.a)(Tt,ht,{entry:kt,on:(pt={},Object(B.a)(pt,C,[{target:Ct,actions:[Gt,Pt],cond:Lt},{target:Ct}]),Object(B.a)(pt,N,{target:"#".concat(Nt),actions:[Bt]}),pt)}),Object(B.a)(Tt,Ct,{entry:Dt,always:[{target:"#".concat(Nt),cond:Mt},{target:ht}]}),Tt)}),Object(B.a)(xt,Nt,{id:Nt,on:(vt={},Object(B.a)(vt,S,{target:gt,actions:[Ft]}),Object(B.a)(vt,_,{target:mt,actions:[wt]}),vt)}),xt)},{guards:(Rt={},Object(B.a)(Rt,Lt,(function(t,e){var n=t.field;return e.type===C&&null===n[e.index]})),Object(B.a)(Rt,Mt,(function(t){var e=t.winCombo,n=t.surrendered,r=t.turnOrder;return Boolean(e||n)||9===r.turnsMade})),Rt),actions:(Et={},Object(B.a)(Et,wt,Object(w.b)(Object(G.a)({},At))),Object(B.a)(Et,Ft,Object(w.b)((function(t){return Object(G.a)(Object(G.a)({},At),{},{opponents:t.opponents,actorTransitionDelay:t.actorTransitionDelay})}))),Object(B.a)(Et,St,Object(w.b)({opponents:function(t,e){if(e.type===E){var n,r,i=t.opponents[e.kind];if(i.type===O)null===(n=(r=i.ref).stop)||void 0===n||n.call(r);var a=e.kind===y?f:j,c=e.value===s?{type:s,symbol:a}:{type:O,ref:Object(F.b)(Ot(a),{name:e.kind}),symbol:a};return Object(G.a)(Object(G.a)({},t.opponents),{},Object(B.a)({},e.kind,c))}return t.opponents}})),Object(B.a)(Et,_t,Object(w.b)({turnOrder:function(t,e){return e.type===g?Object(G.a)(Object(G.a)({},t.turnOrder),{},{current:e.first}):t.turnOrder}})),Object(B.a)(Et,It,Object(w.b)({actorTransitionDelay:function(t,e){return e.type===h?e.delay:t.actorTransitionDelay}})),Object(B.a)(Et,kt,(function(t){var e=t.opponents[t.turnOrder.current];e.type===O&&e.ref.send({type:k,field:t.field,player:t.turnOrder.current,transitionDelay:t.actorTransitionDelay})})),Object(B.a)(Et,Gt,Object(w.b)({field:function(t,e){if(e.type===C){var n=Object(D.a)(t.field),r=t.opponents[e.sender].symbol;return n[e.index]=r,n}return t.field}})),Object(B.a)(Et,Bt,Object(w.b)({surrendered:function(t){return t.turnOrder.current}})),Object(B.a)(Et,Dt,Object(w.b)({winCombo:function(t){var e=t.field,n=t.winCombo,r=x.COMBINATIONS.find((function(t){var n=Object(u.a)(t,3),r=n[0],i=n[1],a=n[2];return!(!e[r]||e[r]!==e[i]||e[r]!==e[a])})),i=e.some((function(t){return null===t}));return r||!i?r:n}})),Object(B.a)(Et,Pt,Object(w.b)({turnOrder:function(t){return Object(G.a)(Object(G.a)({},t.turnOrder),{},{current:t.turnOrder.current===y?b:y,turnsMade:t.turnOrder.turnsMade+1})}})),Et)}),Ut=n(5);Object(d.a)({iframe:function(){return document.getElementById("stately-frame")}});var Wt=function(){},Qt=function(){var t=Object(l.a)(Ht,{devTools:!0}),e=Object(u.a)(t,2),n=e[0],i=e[1];return Object(r.useEffect)((function(){console.log({turn:n.context.turnOrder.turnsMade,context:n.context,events:n.events,value:n.value})})),Object(Ut.jsx)("div",{style:{width:"50%",margin:"10% auto auto auto",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:function(){switch(!0){case n.matches(mt):return Object(Ut.jsxs)("div",{style:{display:"grid",gap:8},children:[Object(Ut.jsx)("button",{style:{minWidth:150,height:50},type:"button",onClick:function(){return i({type:m})},children:"Player vs Player"}),Object(Ut.jsx)("button",{style:{minWidth:150,height:50},type:"button",onClick:function(){i({type:E,kind:b,value:O}),i({type:m})},children:"Player vs AI"}),Object(Ut.jsx)("button",{style:{minWidth:150,height:50},type:"button",onClick:function(){i({type:E,kind:y,value:O}),i({type:E,kind:b,value:O}),i({type:m})},children:"AI vs AI"}),Object(Ut.jsxs)("span",{children:["delay (ms) transitions ",Object(Ut.jsx)("br",{})," to see them in inspector frame:"]}),Object(Ut.jsx)("select",{defaultValue:I.default,onChange:function(t){return i({type:h,delay:Number(t.target.value)})},children:Object.values(I).map((function(t){return Object(Ut.jsx)("option",{value:t,children:t})}))}),Object(Ut.jsxs)("span",{children:["switch from machine(x:n) ",Object(Ut.jsx)("br",{})," to a player in inspector frame ",Object(Ut.jsx)("br",{})," when game starts"]})]});case n.matches(gt):var t=n.context.turnOrder.current,e=n.context.opponents[t].symbol,r=n.context.opponents[t].type===s,a=0===n.context.turnOrder.turnsMade,c=r?function(e){return function(){i({type:C,index:e,sender:t})}}:function(){return Wt};return Object(Ut.jsxs)("div",{style:{display:"grid",gap:16},children:[Object(Ut.jsx)("h3",{children:"".concat(t," (").concat(e,") to make turn")}),Object(Ut.jsx)("div",{style:{display:"grid",gridTemplateColumns:"100px 100px 100px",gridTemplateRows:"100px 100px 100px",gap:8},children:n.context.field.map((function(t,e){return Object(Ut.jsx)("div",{style:{outline:"1px solid gray",cursor:"pointer",fontSize:50,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:(r&&e===x.CENTER||r&&!a)&&null===t?"#cbffb6":"#ffffff",transition:"background .5s ease"},role:"button",tabIndex:e,onKeyDown:Wt,onClick:c(e),children:t},e)}))}),r?Object(Ut.jsx)("button",{type:"button",onClick:function(){return i({type:N})},children:"Give up"}):Object(Ut.jsx)("button",{type:"button",disabled:!0,children:"---"})]});case n.matches(Nt):return Object(Ut.jsxs)("div",{style:{display:"grid",gap:16},children:[Object(Ut.jsx)("h3",{children:"Game ended"}),Object(Ut.jsx)("div",{style:{display:"grid",gridTemplateColumns:"100px 100px 100px",gridTemplateRows:"100px 100px 100px",gap:8},children:n.context.field.map((function(t,e){var r;return Object(Ut.jsx)("div",{title:"".concat(e),style:{outline:"1px solid gray",cursor:"pointer",fontSize:50,display:"flex",justifyContent:"center",alignItems:"center",background:(null===(r=n.context.winCombo)||void 0===r?void 0:r.includes(e))?"green":void 0},children:t},e)}))}),Object(Ut.jsx)("button",{type:"button",onClick:function(){return i({type:S})},children:"Retry"}),Object(Ut.jsx)("button",{type:"button",onClick:function(){return i({type:_})},children:"New game"}),n.context.winCombo&&Object(Ut.jsx)("div",{children:"Win combination ".concat(n.context.winCombo)}),n.context.surrendered&&Object(Ut.jsx)("div",{children:"".concat(n.context.surrendered," surrendered!")}),!n.context.winCombo&&!n.context.surrendered&&Object(Ut.jsx)("div",{children:"It`s a draw"})]});default:return Object(Ut.jsx)("div",{children:"UNKNOWN STATE"})}}()})},Kt=function(){return Object(Ut.jsx)(Qt,{})};c.a.render(Object(Ut.jsx)(i.a.StrictMode,{children:Object(Ut.jsx)(Kt,{})}),document.getElementById("root")),o()}},[[40,1,2]]]);
//# sourceMappingURL=main.58325651.chunk.js.map
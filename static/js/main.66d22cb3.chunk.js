(this["webpackJsonpxstate-tic-tac-toe"]=this["webpackJsonpxstate-tic-tac-toe"]||[]).push([[0],{39:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),i=n(29),c=n.n(i),o=(n(39),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,54)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))}),u=n(23),l=n(10),s=n(51),d=n(52),b=n(11),f=n(33),y=n(14),j=n(2),O=n(53),p=n(7),v=n(50),g=n(24),m=n.n(g),x="user",h="agent",T="player1",k="player2",R="x",C="0",w=[[0,1,2],[3,4,5],[6,7,8]],D=[[0,3,6],[1,4,7],[2,5,8]],I=[[0,4,8],[2,4,6]],L={corners:{topLeft:0,topRight:2,botLeft:6,botRight:8},edges:{top:1,left:3,right:5,bot:7},center:4,combinations:[].concat(w,D,I),rows:w,columns:D,diagonals:I},M=[null,null,null,null,null,null,null,null,null],F="changePlayerReq",P="continueReq",S="changeTurnOrderReq",B="changeTransitionDelayReq",q="acceptTurnReq",E="giveUpReq",G="retryReq",N="setUpNewGame",U={0:0,default:300,500:500,700:700,1e3:1e3},W="makeTurnReq",A="@/awaitingTurn",V="@/makingTurn",J="@/tryingToWin",K="@/tryingToBlockWin",z="@/tryingToFork",H="@/tryingToBlockFork",Q="@/tryingToTakeCenter",X="@/tryingToTakeOppositeCorner",Y="@/tryingToTakeCorner",Z="@/tryingToTakeEmptySide",$="@/givingUp",_="verifyTurnReady",ee="saveField",te="makeTurn",ne="tryWinning",re="tryBlockingWin",ae="tryForking",ie="tryBlockingFork",ce="tryTakingCenter",oe="tryTakingOppositeCorner",ue="tryTakingCorner",le="tryTakingSide",se="giveUp",de=n(16);function be(e){return e===R?C:R}var fe={target:V,cond:_,delay:function(e){return e.transitionDelay}},ye=function(e){var t,n;return Object(O.a)({context:{field:M,player:k,symbol:e,moveReady:null,transitionDelay:U.default},initial:A,states:(t={},Object(j.a)(t,A,{on:Object(j.a)({},W,{target:J,actions:[ee]})}),Object(j.a)(t,V,{after:[{target:A,actions:te,delay:function(e){return e.transitionDelay}}]}),Object(j.a)(t,J,{entry:ne,after:[fe,{target:K,delay:function(e){return e.transitionDelay}}]}),Object(j.a)(t,K,{entry:re,after:[fe,{target:z,delay:function(e){return e.transitionDelay}}]}),Object(j.a)(t,z,{entry:ae,after:[fe,{target:H,delay:function(e){return e.transitionDelay}}]}),Object(j.a)(t,H,{entry:ie,after:[fe,{target:Q,delay:function(e){return e.transitionDelay}}]}),Object(j.a)(t,Q,{entry:ce,after:[fe,{target:X,delay:function(e){return e.transitionDelay}}]}),Object(j.a)(t,X,{entry:oe,after:[fe,{target:Y,delay:function(e){return e.transitionDelay}}]}),Object(j.a)(t,Y,{entry:ue,after:[fe,{target:Z,delay:function(e){return e.transitionDelay}}]}),Object(j.a)(t,Z,{entry:le,after:[fe,{target:$,delay:function(e){return e.transitionDelay}}]}),Object(j.a)(t,$,{after:[{target:A,actions:se,delay:function(e){return e.transitionDelay}}]}),t)},{guards:Object(j.a)({},_,(function(e){var t=e.moveReady;return"commit"===(null===t||void 0===t?void 0:t.type)})),actions:(n={},Object(j.a)(n,ee,Object(p.b)({player:function(e,t){return t.player},field:function(e,t){return t.field},transitionDelay:function(e,t){return t.transitionDelay}})),Object(j.a)(n,te,Object(p.l)((function(e){var t=e.player,n=e.moveReady;return"commit"===(null===n||void 0===n?void 0:n.type)?{type:q,index:n.turnTo,sender:t}:{type:E}}),{delay:300})),Object(j.a)(n,se,Object(p.l)((function(){return{type:E}}),{delay:300})),Object(j.a)(n,ne,Object(p.b)({moveReady:function(e){return je(e.field,e.symbol)}})),Object(j.a)(n,re,Object(p.b)({moveReady:function(e){return je(e.field,be(e.symbol))}})),Object(j.a)(n,ae,Object(p.b)({moveReady:function(e){return Oe(e.field,e.symbol)}})),Object(j.a)(n,ie,Object(p.b)({moveReady:function(e){return Oe(e.field,be(e.symbol))}})),Object(j.a)(n,ce,Object(p.b)({moveReady:function(e){return null===e.field[L.center]?{type:"commit",turnTo:L.center}:{type:"tryOtherMove"}}})),Object(j.a)(n,oe,Object(p.b)({moveReady:function(e){var t=e.field,n=be(e.symbol),r=[{is:t[L.corners.topLeft]===n&&null===t[L.corners.botRight],index:L.corners.botRight},{is:t[L.corners.topRight]===n&&null===t[L.corners.botLeft],index:L.corners.botLeft},{is:t[L.corners.botLeft]===n&&null===t[L.corners.topRight],index:L.corners.topRight},{is:t[L.corners.botRight]===n&&null===t[L.corners.topLeft],index:L.corners.topLeft}].filter((function(e){return e.is})),a=m()(r);return a?{type:"commit",turnTo:a.index}:{type:"tryOtherMove"}}})),Object(j.a)(n,ue,Object(p.b)({moveReady:function(e){var t=e.field,n=[{value:t[L.corners.topLeft],index:L.corners.topLeft},{value:t[L.corners.topRight],index:L.corners.topRight},{value:t[L.corners.botLeft],index:L.corners.botLeft},{value:t[L.corners.botRight],index:L.corners.botRight}].filter((function(e){return null===e.value})),r=m()(n);return r?{type:"commit",turnTo:r.index}:{type:"tryOtherMove"}}})),Object(j.a)(n,le,Object(p.b)({moveReady:function(e){var t=e.field,n=[{value:t[L.edges.top],index:L.edges.top},{value:t[L.edges.left],index:L.edges.left},{value:t[L.edges.right],index:L.edges.right},{value:t[L.edges.bot],index:L.edges.bot}].filter((function(e){return null===e.value})),r=m()(n);return r?{type:"commit",turnTo:r.index}:{type:"tryOtherMove"}}})),n)})};function je(e,t){var n=function(e,t){var n=be(t);return L.combinations.find((function(r){return 2===r.reduce((function(r,a){return e[a]===t?r+1:e[a]===n?r-1:r}),0)}))}(e,t),r=null===n||void 0===n?void 0:n.find((function(t){return null===e[t]}));return void 0!==r?{type:"commit",turnTo:r}:{type:"tryOtherMove"}}function Oe(e,t){var n=function(e,t){var n=function(n){return 1===n.reduce((function(n,r){return e[r]===t?n+1:null===e[r]?n:n-1}),0)},r=w.filter(n),a=D.filter(n),i=I.filter(n);if(r.length){var c,o=Object(de.a)(r);try{for(o.s();!(c=o.n()).done;){var u,l=c.value,s=Object(de.a)(l);try{for(s.s();!(u=s.n()).done;){var d,b=u.value,f=Object(de.a)(a);try{for(f.s();!(d=f.n()).done;){var y=b in d.value,j=null===e[b];if(y&&j)return{intersectionIndex:b}}}catch(S){f.e(S)}finally{f.f()}var O,p=Object(de.a)(i);try{for(p.s();!(O=p.n()).done;){var v=b in O.value,g=null===e[b];if(v&&g)return{intersectionIndex:b}}}catch(S){p.e(S)}finally{p.f()}}}catch(S){s.e(S)}finally{s.f()}}}catch(S){o.e(S)}finally{o.f()}}if(a.length){var m,x=Object(de.a)(a);try{for(x.s();!(m=x.n()).done;){var h,T=m.value,k=Object(de.a)(T);try{for(k.s();!(h=k.n()).done;){var R,C=h.value,M=Object(de.a)(i);try{for(M.s();!(R=M.n()).done;){var F=C in R.value,P=null===e[C];if(F&&P)return{intersectionIndex:C}}}catch(S){M.e(S)}finally{M.f()}}}catch(S){k.e(S)}finally{k.f()}}}catch(S){x.e(S)}finally{x.f()}}return 2===i.length&&null===e[L.center]?{intersectionIndex:L.center}:null}(e,t);return n?{type:"commit",turnTo:n.intersectionIndex}:{type:"tryOtherMove"}}var pe,ve,ge,me,xe,he,Te,ke,Re,Ce,we,De,Ie,Le,Me,Fe,Pe,Se="@/settingUp",Be="@/playing",qe="@/playing/takingTurn",Ee="@/playing/checkingGameState",Ge="@/showingGameEndResults",Ne="setPlayer",Ue="setTurnOrder",We="setTransitionDelay",Ae="awaitTurn",Ve="tryGameEnd",Je="saveTurn",Ke="saveSurrender",ze="switchTurn",He="revertContextToInitial",Qe="revertContextButOpponents",Xe="verifyTurn",Ye="verifyGameEnd",Ze={actorTransitionDelay:U.default,opponents:(pe={},Object(j.a)(pe,T,{type:x,symbol:R}),Object(j.a)(pe,k,{type:x,symbol:C}),pe),turnOrder:{current:T,turnsMade:0},field:M,winCombo:null,surrendered:null},$e=Object(O.a)({context:Ze,initial:Se,states:(he={},Object(j.a)(he,Se,{on:(ve={},Object(j.a)(ve,F,{actions:[Ne]}),Object(j.a)(ve,S,{actions:[Ue]}),Object(j.a)(ve,B,{actions:[We]}),Object(j.a)(ve,P,{target:Be}),ve)}),Object(j.a)(he,Be,{initial:qe,states:(me={},Object(j.a)(me,qe,{entry:Ae,on:(ge={},Object(j.a)(ge,q,[{target:Ee,actions:[Je,ze],cond:Xe},{target:Ee}]),Object(j.a)(ge,E,{target:"#".concat(Ge),actions:[Ke]}),ge)}),Object(j.a)(me,Ee,{entry:Ve,always:[{target:"#".concat(Ge),cond:Ye},{target:qe}]}),me)}),Object(j.a)(he,Ge,{id:Ge,on:(xe={},Object(j.a)(xe,G,{target:Be,actions:[Qe]}),Object(j.a)(xe,N,{target:Se,actions:[He]}),xe)}),he)},{guards:(Te={},Object(j.a)(Te,Xe,(function(e,t){var n=e.field;return t.type===q&&null===n[t.index]})),Object(j.a)(Te,Ye,(function(e){var t=e.winCombo,n=e.surrendered,r=e.turnOrder;return Boolean(t||n)||9===r.turnsMade})),Te),actions:(ke={},Object(j.a)(ke,He,Object(p.b)(Object(y.a)({},Ze))),Object(j.a)(ke,Qe,Object(p.b)((function(e){return Object(y.a)(Object(y.a)({},Ze),{},{opponents:e.opponents,actorTransitionDelay:e.actorTransitionDelay})}))),Object(j.a)(ke,Ne,Object(p.b)({opponents:function(e,t){if(t.type===F){var n,r,a=e.opponents[t.kind];if(a.type===h)null===(n=(r=a.ref).stop)||void 0===n||n.call(r);var i=t.kind===T?R:C,c=t.value===x?{type:x,symbol:i}:{type:h,ref:Object(v.b)(ye(i),{name:t.kind}),symbol:i};return Object(y.a)(Object(y.a)({},e.opponents),{},Object(j.a)({},t.kind,c))}return e.opponents}})),Object(j.a)(ke,Ue,Object(p.b)({turnOrder:function(e,t){return t.type===S?Object(y.a)(Object(y.a)({},e.turnOrder),{},{current:t.first}):e.turnOrder}})),Object(j.a)(ke,We,Object(p.b)({actorTransitionDelay:function(e,t){return t.type===B?t.delay:e.actorTransitionDelay}})),Object(j.a)(ke,Ae,(function(e){var t=e.opponents[e.turnOrder.current];t.type===h&&t.ref.send({type:W,field:e.field,player:e.turnOrder.current,transitionDelay:e.actorTransitionDelay})})),Object(j.a)(ke,Je,Object(p.b)({field:function(e,t){if(t.type===q){var n=Object(f.a)(e.field),r=e.opponents[t.sender].symbol;return n[t.index]=r,n}return e.field}})),Object(j.a)(ke,Ke,Object(p.b)({surrendered:function(e){return e.turnOrder.current}})),Object(j.a)(ke,Ve,Object(p.b)({winCombo:function(e){var t=e.field,n=e.winCombo,r=L.combinations.find((function(e){var n=Object(u.a)(e,3),r=n[0],a=n[1],i=n[2];return!(!t[r]||t[r]!==t[a]||t[r]!==t[i])})),a=t.some((function(e){return null===e}));return r||!a?r:n}})),Object(j.a)(ke,ze,Object(p.b)({turnOrder:function(e){return Object(y.a)(Object(y.a)({},e.turnOrder),{},{current:e.turnOrder.current===T?k:T,turnsMade:e.turnOrder.turnsMade+1})}})),ke)}),_e=b.a.button(Re||(Re=Object(l.a)(["\n  min-width: 150px;\n  height: 50px;\n  cursor: pointer;\n"]))),et=n(4),tt=b.a.div(Ce||(Ce=Object(l.a)(["\n  display: grid;\n  gap: 8px;\n"]))),nt=b.a.select(we||(we=Object(l.a)(["\n  cursor: pointer;\n"]))),rt=Object.values(U).sort((function(e,t){return e>t?1:-1})).map((function(e){return Object(et.jsxs)("option",{value:e,children:[e,"ms"]},e)})),at=function(e){var t=e.send;return Object(et.jsxs)(tt,{children:[Object(et.jsx)(_e,{type:"button",onClick:function(){return t({type:P})},children:"Player vs Player"}),Object(et.jsx)(_e,{type:"button",onClick:function(){t({type:F,kind:k,value:h}),t({type:P})},children:"Player vs AI"}),Object(et.jsx)(_e,{type:"button",onClick:function(){t({type:F,kind:T,value:h}),t({type:F,kind:k,value:h}),t({type:P})},children:"AI vs AI"}),Object(et.jsxs)("span",{children:["delay transitions ",Object(et.jsx)("br",{})," to see them in inspector frame:"]}),Object(et.jsx)(nt,{defaultValue:U.default,onChange:function(e){t({type:B,delay:Number(e.target.value)})},children:rt}),Object(et.jsxs)("span",{children:["switch from machine(x:n) ",Object(et.jsx)("br",{})," to a player in inspector frame ",Object(et.jsx)("br",{})," when game starts"]})]})},it=function(){},ct=b.a.div(De||(De=Object(l.a)(["\n  display: grid;\n  grid-template-columns: 100px 100px 100px;\n  grid-template-rows: 100px 100px 100px;\n  gap: 8px;\n"]))),ot=b.a.div(Ie||(Ie=Object(l.a)(["\n  outline: 1px solid gray;\n  cursor: pointer;\n  font-size: 50px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: ",";\n  transition: background 0.5s ease;\n"])),(function(e){var t=e.isFirstTurn,n=e.isPlayersTurn,r=e.winCombo,a=e.cellValue,i=e.cellIndex;return r?r.includes(i)?"green":void 0:n&&i===L.center&&null===a||n&&!t&&null===a?"#cbffb6":void 0})),ut=a.a.memo((function(e){var t=e.field,n=e.onCellClick,r=e.isFirstTurn,a=e.isPlayersTurn,i=e.winCombo;return Object(et.jsx)(ct,{children:t.map((function(e,t){var c=t;return Object(et.jsx)(ot,{role:"button",tabIndex:c,onKeyDown:it,isFirstTurn:r,isPlayersTurn:a,winCombo:i,cellIndex:c,cellValue:e,onClick:null===n||void 0===n?void 0:n(c),children:e},c)}))})})),lt=b.a.div(Le||(Le=Object(l.a)(["\n  display: grid;\n  gap: 16px;\n"]))),st=b.a.h3(Me||(Me=Object(l.a)([""]))),dt=function(e){var t=e.send,n=e.machineState,r=n.context.turnOrder.current,i=n.context.opponents[r].symbol,c=n.context.opponents[r].type===x,o=0===n.context.turnOrder.turnsMade,u=a.a.useMemo((function(){return c?function(e){return function(){t({type:q,index:e,sender:r})}}:function(){return it}}),[c]);return Object(et.jsxs)(lt,{children:[Object(et.jsx)(st,{children:"".concat(r," (").concat(i,") to make turn")}),Object(et.jsx)(ut,{field:n.context.field,onCellClick:u,isFirstTurn:o,isPlayersTurn:c}),c?Object(et.jsx)(_e,{type:"button",onClick:function(){return t({type:E})},children:"Give up"}):Object(et.jsx)(_e,{type:"button",disabled:!0,children:"---"})]})},bt=b.a.div(Fe||(Fe=Object(l.a)([""]))),ft=function(e){var t=e.send,n=e.machineState,r=n.context,a=r.winCombo,i=r.surrendered;return Object(et.jsxs)(lt,{children:[Object(et.jsx)(st,{children:"Game ended"}),Object(et.jsx)(ut,{field:n.context.field,winCombo:n.context.winCombo}),Object(et.jsx)(_e,{type:"button",onClick:function(){return t({type:G})},children:"Retry"}),Object(et.jsx)(_e,{type:"button",onClick:function(){return t({type:N})},children:"New game"}),a&&Object(et.jsx)(bt,{children:"Win combination ".concat(a)}),i&&Object(et.jsx)(bt,{children:"".concat(i," surrendered!")}),!a&&!i&&Object(et.jsx)(bt,{children:"It`s a draw"})]})};Object(d.a)({iframe:function(){return document.getElementById("stately-frame")}});var yt=b.a.div(Pe||(Pe=Object(l.a)(["\n  margin: 10% auto auto auto;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]))),jt=function(){var e=Object(s.a)($e,{devTools:!0}),t=Object(u.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){console.log({turn:n.context.turnOrder.turnsMade,context:n.context,events:n.events,value:n.value})})),Object(et.jsx)(yt,{children:function(){switch(!0){case n.matches(Se):return Object(et.jsx)(at,{send:a});case n.matches(Be):return Object(et.jsx)(dt,{send:a,machineState:n});case n.matches(Ge):return Object(et.jsx)(ft,{send:a,machineState:n});default:return Object(et.jsx)("div",{children:"UNKNOWN STATE"})}}()})},Ot=function(){return Object(et.jsx)(jt,{})};c.a.render(Object(et.jsx)(a.a.StrictMode,{children:Object(et.jsx)(Ot,{})}),document.getElementById("root")),o()}},[[47,1,2]]]);
//# sourceMappingURL=main.66d22cb3.chunk.js.map